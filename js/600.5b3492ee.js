"use strict";(self["webpackChunkworks"]=self["webpackChunkworks"]||[]).push([[600],{3600:function(t,i,s){s.r(i),s.d(i,{default:function(){return W}});var e=s(3396),a=s(9242),l=s(7139);const r={key:0,class:"row row-cols-2 row-cols-md-3"},o={class:"card border-0 h-100 position-relative"},c=["onClick"],d={class:"product-img"},h=["src","alt"],n={class:"card-body text-center"},u={class:"card-title text-black"},p={class:"card-text h5 fw-bold text-warning"},g={class:"text-secondary m-0"},w={class:"card-body p-0"},m={class:"d-flex align-items-center"},v=["onClick","disabled"],f=["onClick"],k=(0,e._)("i",{class:"bi bi-heart fs-4"},null,-1),y=[k],b=["onClick"],_=(0,e._)("i",{class:"bi bi-heart-fill fs-4"},null,-1),$=[_],L={key:1};function C(t,i,s,k,_,C){const P=(0,e.up)("LoadingOverlay");return(0,e.wg)(),(0,e.iD)(e.HY,null,[(0,e.Wm)(P,{active:_.isLoading},null,8,["active"]),C.filterProducts.length?((0,e.wg)(),(0,e.iD)("div",r,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(C.filterProducts,(i=>((0,e.wg)(),(0,e.iD)("div",{class:"col product-list mb-3",key:i.id},[(0,e._)("div",o,[(0,e._)("a",{href:"#",class:"text-decoration-none h-100",onClick:(0,a.iM)((t=>C.getProduct(i.id)),["prevent"])},[(0,e._)("div",d,[(0,e._)("img",{src:i.imageUrl,class:"card-img-top rounded-0 object-fit-cover w-100",style:{height:"180px"},alt:i.title},null,8,h)]),(0,e._)("div",n,[(0,e._)("h5",u,(0,l.zw)(i.title),1),(0,e._)("p",p,"NT$ "+(0,l.zw)(t.$filters.currency(i.price)),1),(0,e._)("del",g,"NT$ "+(0,l.zw)(t.$filters.currency(i.origin_price)),1)])],8,c),(0,e._)("div",w,[(0,e._)("div",m,[(0,e._)("button",{type:"button",class:"btn btn-outline-secondary w-100",onClick:t=>C.addCart(i.id),disabled:_.status.loadingItem===i.id},"加入購物車",8,v),C.isFavProduct(i.id)?(0,e.kq)("",!0):((0,e.wg)(),(0,e.iD)("a",{key:0,href:"#",class:"link-danger favProduct",onClick:(0,a.iM)((t=>C.addWishList(i)),["prevent"])},y,8,f)),C.isFavProduct(i.id)?((0,e.wg)(),(0,e.iD)("a",{key:1,href:"#",class:"link-danger favProduct",onClick:(0,a.iM)((t=>C.removeWishList(i)),["prevent"])},$,8,b)):(0,e.kq)("",!0)])])])])))),128))])):((0,e.wg)(),(0,e.iD)("div",L,[(0,e._)("h6",null,"很抱歉，找不到"+(0,l.zw)(s.id),1)]))],64)}s(7658);var P={props:["id"],data(){return{products:[],wishlist:JSON.parse(localStorage.getItem("wishlist"))||[],status:{loadingItem:""},isLoading:!1}},inject:["reload","$httpMessageState","emitter","updateWishQty"],computed:{filterProducts(){return this.products.filter((t=>t.title.match(this.id)))}},methods:{getProducts(){const t="https://vue3-course-api.hexschool.io/api/shoppingmall-api/products/all";this.isLoading=!0,this.$http.get(t).then((t=>{this.products=t.data.products,this.isLoading=!1})).catch((t=>{this.$httpMessageState(t,"連線"),this.isLoading=!1}))},getProduct(t){this.$router.push(`/user/product/${t}`)},addCart(t){const i="https://vue3-course-api.hexschool.io/api/shoppingmall-api/cart";this.status.loadingItem=t,this.isLoading=!0;const s={product_id:t,qty:1};this.$http.post(i,{data:s}).then((t=>{this.status.loadingItem="",this.reload(),this.isLoading=!1,setTimeout((()=>{this.$httpMessageState(t,"加入購物車")}))})).catch((t=>{this.$httpMessageState(t,"連線"),this.isLoading=!1}))},isFavProduct(t){return this.wishlist.some((i=>i.id===t))},addWishList(t){this.wishlist.push(t),localStorage.setItem("wishlist",JSON.stringify(this.wishlist)),this.updateWishQty(this.wishlist.length),this.emitter.emit("push-message",{style:"success",title:`${t.title}已加入最愛`})},removeWishList(t){this.wishlist=this.wishlist.filter((i=>i.id!==t.id)),localStorage.setItem("wishlist",JSON.stringify(this.wishlist)),this.updateWishQty(this.wishlist.length),this.emitter.emit("push-message",{style:"danger",title:`${t.title}已刪除最愛商品`})}},created(){this.getProducts()}},x=s(89);const S=(0,x.Z)(P,[["render",C]]);var W=S}}]);
//# sourceMappingURL=600.5b3492ee.js.map